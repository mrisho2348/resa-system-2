{% load static %}
<!doctype html>
<html lang="zxx">
<head>
    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="keywords" content="Site keywords here">
    <meta name="description" content="">
    <meta name='copyright' content=''>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>RESA</title>

    <!-- Favicon -->
    <link rel="icon" href="{% static 'img/resalogo.jpg' %}">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Nice Select CSS -->
    <link rel="stylesheet" href="{% static 'css/nice-select.css' %}">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
    <!-- icofont CSS -->
    <link rel="stylesheet" href="{% static 'css/icofont.css' %}">
    <!-- Slicknav -->
    <link rel="stylesheet" href="{% static 'css/slicknav.min.css' %}">
    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="{% static 'css/owl-carousel.css' %}">
    <!-- Datepicker CSS -->
    <link rel="stylesheet" href="{% static 'css/datepicker.css' %}">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
    <!-- Magnific Popup CSS -->
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

    <!-- Medipro CSS -->
    <link rel="stylesheet" href="{% static 'css/normalize.css' %}">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
</head>
<body>

    <!-- Preloader -->
    <div class="preloader">
        <div class="loader">
            <div class="loader-outter"></div>
            <div class="loader-inner"></div>

            <div class="indicator">
                <svg width="16px" height="12px">
                    <polyline id="back" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
                    <polyline id="front" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
                </svg>
            </div>
        </div>
    </div>
    <!-- End Preloader -->

    <!-- Header Area -->
    {% include "topbar.html" %}
    <!-- End Header Area -->

    <!-- Breadcrumbs -->
    <div class="breadcrumbs overlay">
        <div class="container">
            <div class="bread-inner">
                <div class="row">
                    <div class="col-12">
                        <h2>Create Account</h2>
                        <ul class="bread-list">
                            <li><a href="{% url 'clinic:home' %}">Home</a></li>
                            <li><i class="icofont-simple-right"></i></li>
                            <li class="active">Create Account</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Breadcrumbs -->

    <!-- Start Contact Us -->
    <section class="contact-us section">
        <div class="container">
            {% url 'clinic:add_staff' as action_path %}
            {% include 'form_templates.html' with messages=messages forms=forms action_path=action_path button_text="Create Account" %}
        </div>
    </section>
    <!-- End Contact Us -->

    <!-- Footer Area -->
    {% include "footer.html" %}
    <!-- End Footer Area -->

    <!-- jquery Min JS -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <!-- jquery Migrate JS -->
    <script src="{% static 'js/jquery-migrate-3.0.0.js' %}"></script>
    <!-- jquery Ui JS -->
    <script src="{% static 'js/jquery-ui.min.js' %}"></script>
    <!-- Easing JS -->
    <script src="{% static 'js/easing.js' %}"></script>
    <!-- Color JS -->
    <script src="{% static 'js/colors.js' %}"></script>
    <!-- Popper JS -->
    <script src="{% static 'js/popper.min.js' %}"></script>
    <!-- Bootstrap Datepicker JS -->
    <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
    <!-- Jquery Nav JS -->
    <script src="{% static 'js/jquery.nav.js' %}"></script>
    <!-- Slicknav JS -->
    <script src="{% static 'js/slicknav.min.js' %}"></script>
    <!-- ScrollUp JS -->
    <script src="{% static 'js/jquery.scrollUp.min.js' %}"></script>
    <!-- Niceselect JS -->
    <script src="{% static 'js/niceselect.js' %}"></script>
    <!-- Tilt Jquery JS -->
    <script src="{% static 'js/tilt.jquery.min.js' %}"></script>
    <!-- Owl Carousel JS -->
    <script src="{% static 'js/owl-carousel.js' %}"></script>
    <!-- counterup JS -->
    <script src="{% static 'js/jquery.counterup.min.js' %}"></script>
    <!-- Steller JS -->
    <script src="{% static 'js/steller.js' %}"></script>
    <!-- Wow JS -->
    <script src="{% static 'js/wow.min.js' %}"></script>
    <!-- Magnific Popup JS -->
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <!-- Counter Up CDN JS -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.3/waypoints.min.js"></script>
    <!-- Google Map API Key JS -->
    <script src="https://maps.google.com/maps/api/js?key=AIzaSyDGqTyqoPIvYxhn_Sa7ZrK5bENUWhpCo0w"></script>
    <!-- Gmaps JS -->
    <script src="{% static 'js/gmaps.min.js' %}"></script>
    <!-- Map Active JS -->
    <script src="{% static 'js/map-active.js' %}"></script>
    <!-- Bootstrap JS -->
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- Main JS -->
    <script src="{% static 'js/main.js' %}"></script>

    <script>
      $(document).ready(function () {
          function checkAvailability(fieldId, url, paramName, messageClass) {
              $(fieldId).on("input", function () {
                  var value = $(this).val().trim();
  
                  if (value === "") {
                      $("." + messageClass).remove();
                      return;
                  }
  
                  $.ajax({
                      url: url,
                      type: "POST",
                      data: { [paramName]: value },
                      headers: { "X-CSRFToken": "{{ csrf_token }}" },
                  })
                  .done(function (response) {
                      console.log(response);
                      $("." + messageClass).remove();
                      
                      if (response === "True") {
                          var message = `<span class='${messageClass}' style='padding: 5px; color: red; font-weight: bold;'>Available</span>`;
                          $(message).insertAfter(fieldId);
                      }
                  })
                  .fail(function () {
                      console.log("Failed");
                  });
              });
          }
  
          // Check if email and username are available
          checkAvailability("#id_email", "{% url 'clinic:check_email_exist' %}", "email", "email_error");
          checkAvailability("#id_username", "{% url 'clinic:check_username_exist' %}", "username", "username_error");
  
          // Password Matching Validation
          $("#id_password, #id_confirm_password").on("input", function () {
              var password = $("#id_password").val();
              var confirmPassword = $("#id_confirm_password").val();
              $(".password_error").remove();
  
              if (password !== confirmPassword) {
                  var message = `<span class='password_error' style='color: red; font-weight: bold;'>Passwords do not match</span>`;
                  $(message).insertAfter("#id_confirm_password");
              }
          });
  
          // Username should not be an email address validation
          $("#id_username").on("input", function () {
              var username = $(this).val().trim();
              $(".username_email_error").remove();
  
              // Check if username contains an "@" symbol (indicating it's an email)
              if (username.includes("@")) {
                  var message = `<span class='username_email_error' style='color: red; font-weight: bold;'>Username should not be an email address.</span>`;
                  $(message).insertAfter("#id_username");
              }
          });
  
          // Date of Birth Validation (Age above 18)
          $("#id_date_of_birth").on("input", function () {
              var dob = new Date($(this).val());
              var today = new Date();
              var age = today.getFullYear() - dob.getFullYear();
              var monthDifference = today.getMonth() - dob.getMonth();
              if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < dob.getDate())) {
                  age--;
              }
  
              $(".dob_error").remove();
              if (age < 18) {
                  var message = `<span class='dob_error' style='color: red; font-weight: bold;'>Any staff must be at least 18 years old.</span>`;
                  $(message).insertAfter("#id_date_of_birth");
              }
          });
  
          // Joining Date Validation (Cannot be in the future)
          $("#id_joining_date").on("input", function () {
              var joiningDate = new Date($(this).val());
              var today = new Date();
  
              $(".joining_date_error").remove();
              if (joiningDate > today) {
                  var message = `<span class='joining_date_error' style='color: red; font-weight: bold;'>Joining date cannot be in the future.</span>`;
                  $(message).insertAfter("#id_joining_date");
              }
          });
  
          // MCT Number Unique Validation (if provided)
          $("#id_mct_number").on("input", function () {
              var mctNumber = $(this).val().trim();
  
              if (mctNumber === "") {
                  return; // Skip if no MCT number is provided
              }
  
              $.ajax({
                  url: "{% url 'clinic:check_mct_number_exist' %}",
                  type: "POST",
                  data: { "mct_number": mctNumber },
                  headers: { "X-CSRFToken": "{{ csrf_token }}" },
              })
              .done(function (response) {
                  $(".mct_number_error").remove();
                  
                  if (response === "True") {
                      var message = `<span class='mct_number_error' style='color: red; font-weight: bold;'>MCT number already exists. Please provide a unique MCT number.</span>`;
                      $(message).insertAfter("#id_mct_number");
                  }
              })
              .fail(function () {
                  console.log("Failed to check MCT number.");
              });
          });
      });
  </script>
  

</body>
</html>
